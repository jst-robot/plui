(this.webpackJsonpplui=this.webpackJsonpplui||[]).push([[0],{99:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(13),s=n.n(a),i=(n(84),n(7)),u=n.n(i),j=n(15),l=n(39),o=n(12),b=(n(86),n(128)),d=n(152),x=n(130),O=n(132),h=n(133),f=n(151),p=n(134),m=n(135),v=n(70),w=n(136),g=n(2),S=Object(b.a)((function(e){return Object(d.a)({title:{flexGrow:1},link:{color:"white","&:hover":{color:"white",textDecoration:"none"}}})})),k=function(e){var t=S();return Object(g.jsxs)("div",{children:[Object(g.jsx)(x.a,{position:"static",children:Object(g.jsxs)(O.a,{children:[Object(g.jsx)(h.a,{variant:"h4",className:t.title,children:Object(g.jsx)(l.b,{to:"/",className:t.link,children:"PLUI"})}),Object(g.jsx)(f.a,{children:Object(g.jsx)(p.a,{children:Object(g.jsx)(l.b,{to:"/experiments",className:t.link,children:"\u5b9f\u9a13\u4e00\u89a7"})})}),Object(g.jsx)(f.a,{children:Object(g.jsx)(m.a,{color:"inherit",children:Object(g.jsx)(l.b,{to:"/experiments/new",className:t.link,children:Object(g.jsx)(w.a,{})})})})]})}),Object(g.jsx)(v.a,{elevation:0,children:Object(g.jsx)("div",{children:e.children})})]})},y=n(10),I=n(21),N=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("devices"),e.abrupt("return",null===t?[]:JSON.parse(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:return n=e.sent,r=n.filter((function(e){return e.name===t})),e.abrupt("return",0===r.length?null:r[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(j.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:return t=e.sent,e.next=5,N();case 5:n=e.sent.map((function(e){var n=e.name,r=e.cap,c=e.time;return{name:n,cap:r,jobs:t.filter((function(e){var t=e.device,r=e.status;return t===n&&"run"===r})).length,time:c}})),localStorage.setItem("devices",JSON.stringify(n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("experiments"),e.abrupt("return",null===t?[]:JSON.parse(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(j.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:return n=e.sent,r=n.filter((function(e){return e.id===t})),e.abrupt("return",0===r.length?null:r[0]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Promise,e.next=3,J();case 3:return e.t1=e.sent.map(function(){var e=Object(j.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=Date.now())-t.submit<2e3)){e.next=3;break}return e.abrupt("return",Object(I.a)(Object(I.a)({},t),{},{status:"queue"}));case 3:return e.next=5,D(t.device);case 5:if(null!==(r=e.sent)){e.next=8;break}return e.abrupt("return",Object(I.a)(Object(I.a)({},t),{},{status:"error"}));case 8:if("queue"!==t.status){e.next=12;break}if(!(r.jobs<r.cap)){e.next=11;break}return e.abrupt("return",Object(I.a)(Object(I.a)({},t),{},{start:n,status:"run"}));case 11:return e.abrupt("return",t);case 12:if("run"!==t.status||!t.start){e.next=16;break}if(!(n-t.start<1e3*r.time)){e.next=15;break}return e.abrupt("return",t);case 15:return e.abrupt("return",Object(I.a)(Object(I.a)({},t),{},{end:n,status:"done"}));case 16:return t.status,e.abrupt("return",t);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=6,e.t0.all.call(e.t0,e.t1);case 6:t=e.sent,localStorage.setItem("experiments",JSON.stringify(t));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(j.a)(u.a.mark((function e(t,n,r){var c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:c=e.sent,a=[{id:c.length,name:t,device:n,submit:Date.now(),start:null,end:null,status:"queue"}].concat(Object(y.a)(c)),localStorage.setItem("experiments",JSON.stringify(a));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),_=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("experiments");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=n(17),P=n(137),F=n(138),T=n(139),B=n(140),R=n(141),G=n(142),M=n(143),U=function(){var e=Object(r.useState)([]),t=Object(E.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){N().then(c);var e=setInterval((function(){return N().then(c)}),1e3);return function(){return clearInterval(e)}}),[]),Object(g.jsx)(k,{children:Object(g.jsx)(P.a,{maxWidth:"md",children:Object(g.jsx)(v.a,{children:Object(g.jsx)(F.a,{children:Object(g.jsxs)(T.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsxs)(R.a,{children:[Object(g.jsx)(G.a,{children:"\u540d\u524d"}),Object(g.jsx)(G.a,{children:"\u72b6\u614b"})]})}),Object(g.jsx)(M.a,{children:n.map((function(e){var t=e.name,n=e.cap,r=e.jobs;return Object(g.jsxs)(R.a,{children:[Object(g.jsx)(G.a,{children:Object(g.jsx)(h.a,{children:t})}),Object(g.jsx)(G.a,{children:Object(g.jsxs)(h.a,{children:[r,"/",n]})})]},t)}))})]})})})})})},V=n(59),z=n(60),A=n(47),H={queue:Object(g.jsx)(A.a,{icon:V.b}),run:Object(g.jsx)(A.a,{icon:z.b,pulse:!0}),error:Object(g.jsx)(A.a,{icon:z.a}),done:Object(g.jsx)(A.a,{icon:V.a})},K=function(e){return console.log(e.status),H[e.status]},Q=n(144),X=n(145),Y=function(e){var t=Object(r.useState)(null),n=Object(E.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){W(e.experiment_id).then(a);var t=setInterval((function(){W(e.experiment_id).then(a)}),1e3);return function(){return clearInterval(t)}}),[e.experiment_id]),null===c?Object(g.jsx)(k,{children:"Not found"}):Object(g.jsx)(k,{children:Object(g.jsx)(P.a,{maxWidth:"md",children:Object(g.jsx)(Q.a,{children:Object(g.jsxs)(X.a,{children:[Object(g.jsxs)(h.a,{color:"textSecondary",children:["\u9001\u4fe1\uff1a ",new Date(c.submit).toLocaleString()]}),Object(g.jsxs)(h.a,{color:"textSecondary",children:["\u958b\u59cb\uff1a",c.start&&new Date(c.start).toLocaleString()]}),Object(g.jsxs)(h.a,{color:"textSecondary",children:["\u7d42\u4e86\uff1a",c.end&&new Date(c.end).toLocaleString()]}),Object(g.jsx)(h.a,{variant:"h6",children:c.name}),Object(g.jsx)(h.a,{children:c.device}),Object(g.jsx)(K,{status:c.status})]})})})})},Z=Object(b.a)((function(e){return Object(d.a)({tableRow:{cursor:"pointer"}})})),$=function(){var e=Z(),t=Object(o.f)(),n=Object(r.useState)([]),c=Object(E.a)(n,2),a=c[0],s=c[1];Object(r.useEffect)((function(){J().then(s);var e=setInterval((function(){J().then(s)}),1e3);return function(){return clearInterval(e)}}),[]);var i=function(){var e=Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_();case 2:J().then(s);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsx)(k,{children:Object(g.jsx)(P.a,{maxWidth:"md",children:Object(g.jsxs)(v.a,{children:[Object(g.jsx)(O.a,{children:Object(g.jsx)(p.a,{variant:"contained",color:"secondary",onClick:i,children:"\u5168\u524a\u9664"})}),Object(g.jsx)(F.a,{children:Object(g.jsxs)(T.a,{children:[Object(g.jsx)(B.a,{children:Object(g.jsxs)(R.a,{children:[Object(g.jsx)(G.a,{children:"\u9001\u4fe1"}),Object(g.jsx)(G.a,{children:"\u958b\u59cb"}),Object(g.jsx)(G.a,{children:"\u7d42\u4e86"}),Object(g.jsx)(G.a,{children:"\u5b9f\u9a13\u540d"}),Object(g.jsx)(G.a,{children:"\u6a5f\u5668\u540d"}),Object(g.jsx)(G.a,{children:"\u5b9f\u884c\u72b6\u614b"})]})}),Object(g.jsx)(M.a,{children:a.map((function(n){var r=n.id,c=n.name,a=n.device,s=n.submit,i=n.start,u=n.end,j=n.status;return Object(g.jsxs)(R.a,{hover:!0,className:e.tableRow,onClick:function(){return t.push("/experiments/".concat(r))},children:[Object(g.jsx)(G.a,{children:Object(g.jsx)(h.a,{color:"textSecondary",children:new Date(s).toLocaleString()})}),Object(g.jsx)(G.a,{children:Object(g.jsx)(h.a,{color:"textSecondary",children:i&&new Date(i).toLocaleString()})}),Object(g.jsx)(G.a,{children:Object(g.jsx)(h.a,{color:"textSecondary",children:u&&new Date(u).toLocaleString()})}),Object(g.jsx)(G.a,{children:Object(g.jsx)(h.a,{variant:"subtitle1",children:c})}),Object(g.jsx)(G.a,{children:Object(g.jsx)(h.a,{variant:"subtitle1",children:a})}),Object(g.jsx)(G.a,{children:Object(g.jsx)(K,{status:j})})]},r)}))})]})})]})})})},ee=n(54),te=n(146),ne=n(153),re=n(155),ce=n(150),ae=n(156),se=n(149),ie=Object(b.a)((function(e){return Object(d.a)({select:{minWidth:120}})})),ue=function(e){var t=ie(),n=Object(o.f)(),r=Object(ee.b)(),c=r.control,a=r.handleSubmit,s=r.formState.errors;return Object(g.jsx)(k,{children:Object(g.jsx)(P.a,{maxWidth:"sm",children:Object(g.jsx)(v.a,{children:Object(g.jsx)(P.a,{children:Object(g.jsxs)(te.a,{container:!0,spacing:2,children:[Object(g.jsx)(te.a,{item:!0,xs:12,children:Object(g.jsx)(ee.a,{name:"name",control:c,defaultValue:"",rules:{required:!0},render:function(e){var t=e.field;return Object(g.jsx)(ne.a,Object(I.a)({label:"\u5b9f\u9a13\u540d",fullWidth:!0,error:"name"in s,helperText:"name"in s?"\u5fc5\u9808\u9805\u76ee":""},t))}})}),Object(g.jsxs)(te.a,{item:!0,xs:12,children:[Object(g.jsx)(re.a,{error:"device"in s,id:"device-label",children:"\u6a5f\u5668\u540d"}),Object(g.jsx)(ee.a,{name:"device",control:c,rules:{required:!0},render:function(e){var n=e.field;return Object(g.jsxs)(ce.a,Object(I.a)(Object(I.a)({labelId:"device-label",error:"device"in s,className:t.select},n),{},{children:[Object(g.jsx)(ae.a,{value:"\u30d7\u30ea\u30f3\u30bf\uff11",children:"\u30d7\u30ea\u30f3\u30bf\uff11"}),Object(g.jsx)(ae.a,{value:"\u30d7\u30ea\u30f3\u30bf\uff12",children:"\u30d7\u30ea\u30f3\u30bf\uff12"}),Object(g.jsx)(ae.a,{value:"\u5927\u5224\u30d7\u30ea\u30f3\u30bf",children:"\u5927\u5224\u30d7\u30ea\u30f3\u30bf"})]}))}}),Object(g.jsx)(se.a,{error:"device"in s,children:"device"in s?"\u5fc5\u9808\u9805\u76ee":""})]}),Object(g.jsx)(te.a,{item:!0,xs:12,children:Object(g.jsx)(p.a,{variant:"contained",color:"primary",onClick:a((function(e){var t=e.name,r=e.device;C(t,r),n.push("/experiments")})),children:"\u9001\u4fe1"})})]})})})})})},je=function(){return Object(r.useEffect)((function(){localStorage.setItem("devices",JSON.stringify([{name:"\u30d7\u30ea\u30f3\u30bf\uff11",cap:10,jobs:0,time:5},{name:"\u30d7\u30ea\u30f3\u30bf\uff12",cap:5,jobs:0,time:10},{name:"\u5927\u5224\u30d7\u30ea\u30f3\u30bf",cap:1,jobs:0,time:60}]));var e=setInterval(Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:return e.next=4,L();case 4:case"end":return e.stop()}}),e)}))),500);return function(){return clearInterval(e)}})),Object(g.jsx)(l.a,{basename:"/plui",children:Object(g.jsxs)(o.c,{children:[Object(g.jsx)(o.a,{path:"/",exact:!0,children:Object(g.jsx)(U,{})}),Object(g.jsx)(o.a,{path:"/experiments",exact:!0,children:Object(g.jsx)($,{})}),Object(g.jsx)(o.a,{path:"/experiments/new",exact:!0,children:Object(g.jsx)(ue,{})}),Object(g.jsx)(o.a,{path:"/experiments/:experiment_id",render:function(e){var t=e.match;return Object(g.jsx)(Y,{experiment_id:parseInt(t.params.experiment_id)})}}),Object(g.jsx)(o.a,{path:"*",children:Object(g.jsx)(k,{children:Object(g.jsx)(P.a,{maxWidth:"sm",children:"404: Page not found."})})})]})})},le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,158)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(je,{})}),document.getElementById("root")),le()}},[[99,1,2]]]);
//# sourceMappingURL=main.7b1630d7.chunk.js.map